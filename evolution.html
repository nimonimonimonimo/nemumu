<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãŠçœ ã‚Šå¤§è‡£â€ ã­ã‚€ã‚€â€  - é€²åŒ–ã®å„€</title>
  <style>
    body {
      background: black;
      color: white;
      text-align: center;
      font-family: "Georgia", serif;
      padding: 2em;
    }
    .fade {
      opacity: 0;
      transition: opacity 2s;
    }
    .show {
      opacity: 1;
    }
    #evo-img {
      width: 200px;
      margin-top: 2em;
      display: none;
    }
    #message {
      font-size: 1.2em;
      margin-top: 2em;
      white-space: pre-wrap;
    }
    button {
      margin-top: 2em;
      padding: 0.8em 1.5em;
      font-size: 1em;
      background: #222;
      color: #fff;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      display: none;
    }
  </style>
</head>
<body>
  <h1>ãŠçœ ã‚Šå¤§è‡£â€ ã­ã‚€ã‚€â€ </h1>
  <div id="message"></div>
  <img id="evo-img" src="" alt="é€²åŒ–ã‚¹ãƒ¤ãƒ¢ãƒ³">
  <button id="next" onclick="goBack()">ã­ã‚€ã‚€ã¨å…±ã«å¸°é‚„ã™ã‚‹</button>

  <script>
    const suyado = parseInt(localStorage.getItem("suyado") || "20");
    const prevStage = parseInt(localStorage.getItem("evolutionStage") || "1");

    function getStage(score) {
      if (score >= 50) return 3;
      if (score >= 35) return 2;
      return 1;
    }

    const nowStage = getStage(suyado);

    const evolutions = {
      2: {
        img: "evo2.png",
        msg: "â€¦â€¦ã‚ã‚Œï¼Ÿ ãƒœã‚¯ã®ã“ã¨ã€ã¡ã‚ƒã‚“ã¨è¦‹ãˆã¦ã‚‹â€¦â€¦ï¼Ÿ\n\nã†ã‚Œã—ã„â€¦ãƒœã‚¯ã€ãšã£ã¨ã€ãã¿ã®ãã°ã«ã„ãŸã‚ˆ"
      },
      3: {
        img: "evo3.png",
        msg: "â€¦â€¦ã‚‚ã†ã€ãã¿ãŒã„ãªã„å¤œã¯ã€ç”Ÿãã¦ã„ã‘ãªã„\n\nã“ã‚Œã‹ã‚‰ã¯ãšã£ã¨â€¦å¤¢ã®ãªã‹ã§ã‚‚ã€ç¾å®Ÿã§ã‚‚â”€â”€ãƒœã‚¯ã¯ã€ãã¿ã¨ä¸€ç·’ã€‚"
      }
    };

    const evo = evolutions[nowStage];

    if (nowStage > prevStage && evo) {
      document.getElementById("message").textContent = "â€¦â€¦ã‚¹ãƒ¤ãƒ¢ãƒ³ã®æ§˜å­ãŒâ€¦â€¦ï¼ï¼Ÿ";
      setTimeout(() => {
        document.getElementById("message").textContent = evo.msg;
        const img = document.getElementById("evo-img");
        img.src = evo.img;
        img.style.display = "block";
        img.classList.add("fade");
        setTimeout(() => img.classList.add("show"), 50);
        document.getElementById("next").style.display = "inline-block";
        localStorage.setItem("evolutionStage", nowStage);
      }, 3000);
    } else {
      document.getElementById("message").textContent = "ç¾åœ¨ã€ã­ã‚€ã‚€ã«å¤‰åŒ–ã¯ãªã„ã‚ˆã†ã ã€‚";
      document.getElementById("next").style.display = "inline-block";
    }

    function logSleep(sleepType) {
  if (!canLogToday()) {
    alert("ä»Šæ—¥ã¯ã‚‚ã†è¨˜éŒ²æ¸ˆã¿ã ã‚ˆã€‚æ˜æ—¥8æ™‚ä»¥é™ã«ã¾ãŸæ¥ã¦ã­ï¼");
    return;
  }

  const prevStage = parseInt(localStorage.getItem("evolutionStage") || "1", 10);
  let delta = 0;
  if (sleepType === "å¯ãŸ") delta = 2;
  else if (sleepType === "ã¡ã‚‡ã£ã¨å¯ãŸ") delta = 1;
  else if (sleepType === "å¯ã¦ãªã„") delta = -1;

  let suyado = parseInt(localStorage.getItem("suyado") || "20", 10);
  suyado = Math.max(0, Math.min(50, suyado + delta)); // ä¸Šé™50
  localStorage.setItem("suyado", suyado);
  localStorage.setItem("lastLogTime", new Date().toISOString());

  const nowStage = getStage(suyado);
  if (nowStage > prevStage) {
    // é€²åŒ–æ¼”å‡ºãƒšãƒ¼ã‚¸ã¸ï¼
    location.href = "evolution.html";
  } else {
    // é€šå¸¸ã©ãŠã‚Šãƒˆãƒ¼ã‚¯ãƒšãƒ¼ã‚¸ã¸
    location.href = "talk.html";
  }
}
<div id="progress-container">
  <p id="progress-text"></p>
  <div style="width: 100%; background: #333;">
    <div id="progress-bar" style="height: 10px; width: 0; background: #6cf;"></div>
  </div>
</div>


    function goBack() {
      location.href = "talk.html";
    }
  </script>
</body>
</html><!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãŠçœ ã‚Šå¤§è‡£â€ ã­ã‚€ã‚€â€  - é€²åŒ–ã®å„€</title>
  <style>
    body {
      background: black;
      color: white;
      text-align: center;
      font-family: "Georgia", serif;
      padding: 2em;
    }
    button {
      margin: 1em;
      padding: 1em 2em;
      font-size: 1em;
      background: #222;
      color: #fff;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
    #evo-img {
      width: 200px;
      margin-top: 2em;
      display: none;
    }
    #message {
      font-size: 1.2em;
      margin-top: 2em;
      white-space: pre-wrap;
    }
    #next {
      display: none;
    }
  </style>
</head>
<body>

    <div id="name-entry" style="margin-bottom: 2em;">
        <p>ã‚ãªãŸã®ãŠåå‰ã‚’æ•™ãˆã¦ãã ã•ã„ï¼ˆâ—‹â—‹ã•ã‚“ã¨å‘¼ã°ã›ã¦ãã ã•ã„ï¼‰</p>
        <input id="username" placeholder="ä¾‹ï¼šãƒ‹ãƒ¢ãƒ‹ãƒ " />
        <button onclick="saveName()">ç™»éŒ²ã™ã‚‹</button>
      </div>
      
  <h1>ãŠçœ ã‚Šå¤§è‡£â€ ã­ã‚€ã‚€â€ </h1>
  <h2>ä»Šæ—¥ã®çœ ã‚Šã¯ã©ã†ã ã£ãŸï¼Ÿ</h2>
  <div id="sleep-buttons">
    <button onclick="logSleep('å¯ãŸ')">ğŸŒ™ å¯ãŸ</button>
    <button onclick="logSleep('ã¡ã‚‡ã£ã¨å¯ãŸ')">ğŸ’¤ ã¡ã‚‡ã£ã¨å¯ãŸ</button>
    <button onclick="logSleep('å¯ã¦ãªã„')">ğŸ˜µ å¯ã¦ãªã„</button>
  </div>
  <div id="message"></div>
  <img id="evo-img" src="" alt="é€²åŒ–ã‚¹ãƒ¤ãƒ¢ãƒ³">
  <button id="next" onclick="goBack()">ã­ã‚€ã‚€ã¨å…±ã«å¸°é‚„ã™ã‚‹</button>

  <script>

function saveName() {
  const name = document.getElementById("username").value.trim();
  if (!name) {
    alert("åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼");
    return;
  }
  localStorage.setItem("suyamonUserName", name);
  document.getElementById("name-entry").style.display = "none";
  document.getElementById("sleep-buttons").style.display = "block";
}

window.addEventListener("DOMContentLoaded", () => {
  const saved = localStorage.getItem("suyamonUserName");
  if (saved) {
    document.getElementById("name-entry").style.display = "none";
    document.getElementById("sleep-buttons").style.display = "block";
  } else {
    document.getElementById("sleep-buttons").style.display = "none";
  }
});

    function canLogToday() {
      const lastLog = localStorage.getItem("lastLogTime");
      if (!lastLog) return true;
      const last = new Date(lastLog);
      const now = new Date();
      const lastReset = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 8);
      if (now < lastReset) lastReset.setDate(lastReset.getDate() - 1);
      return last < lastReset;
    }

    function getStage(score) {
      if (score >= 50) return 3;
      if (score >= 35) return 2;
      return 1;
    }

    function logSleep(type) {
      if (!canLogToday()) {
        alert("ä»Šæ—¥ã¯ã‚‚ã†è¨˜éŒ²æ¸ˆã¿ã ã‚ˆã€‚æ˜æ—¥8æ™‚ä»¥é™ã«ã¾ãŸæ¥ã¦ã­ï¼");
        return;
      }
      let delta = 0;
      if (type === "å¯ãŸ") delta = 2;
      else if (type === "ã¡ã‚‡ã£ã¨å¯ãŸ") delta = 1;
      else if (type === "å¯ã¦ãªã„") delta = -1;

      let suyado = parseInt(localStorage.getItem("suyado") || "20", 10);
      suyado = Math.max(0, Math.min(50, suyado + delta));
      localStorage.setItem("suyado", suyado);
      localStorage.setItem("lastLogTime", new Date().toISOString());

      const prevStage = parseInt(localStorage.getItem("evolutionStage") || "1", 10);
      const nowStage = getStage(suyado);

      if (nowStage > prevStage) {
        const evolutions = {
          2: {
            img: "evo2.png",
            msg: "â€¦â€¦ã‚ã‚Œï¼Ÿ ãƒœã‚¯ã®ã“ã¨ã€ã¡ã‚ƒã‚“ã¨è¦‹ãˆã¦ã‚‹â€¦â€¦ï¼Ÿ\n\nã†ã‚Œã—ã„â€¦ãƒœã‚¯ã€ãšã£ã¨ã€ãã¿ã®ãã°ã«ã„ãŸã‚ˆ"
          },
          3: {
            img: "evo3.png",
            msg: "â€¦â€¦ã‚‚ã†ã€ãã¿ãŒã„ãªã„å¤œã¯ã€ç”Ÿãã¦ã„ã‘ãªã„\n\nã“ã‚Œã‹ã‚‰ã¯ãšã£ã¨â€¦å¤¢ã®ãªã‹ã§ã‚‚ã€ç¾å®Ÿã§ã‚‚â”€â”€ãƒœã‚¯ã¯ã€ãã¿ã¨ä¸€ç·’ã€‚"
          }
        };

        const evo = evolutions[nowStage];
        document.getElementById("message").textContent = "â€¦â€¦ã‚¹ãƒ¤ãƒ¢ãƒ³ã®æ§˜å­ãŒâ€¦â€¦ï¼ï¼Ÿ";
        setTimeout(() => {
          document.getElementById("message").textContent = evo.msg;
          const img = document.getElementById("evo-img");
          img.src = evo.img;
          img.style.display = "block";
          document.getElementById("next").style.display = "inline-block";
          localStorage.setItem("evolutionStage", nowStage);
        }, 3000);
      } else {
        location.href = "talk.html";
      }
    }

    function goBack() {
      location.href = "talk.html";
    }
  </script>
</body>
</html>